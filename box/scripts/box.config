#!/system/bin/sh
# Configuration (modify as needed)
# Proxy core configuration
bin_name_list=("sing-box" "clash" "mihomo" "xray" "v2ray" "hysteria")
bin_name="sing-box"
# Proxy running user and group
CORE_USER_GROUP="root:net_admin"
# Proxy ports (transparent proxy listening ports)
PROXY_TCP_PORT="1536"
PROXY_UDP_PORT="1536"

# Proxy mode: auto (check TPROXY support), TPROXY, REDIRECT, Core
PROXY_MODE="auto"

# DNS configuration
# DNS hijack method (0=disabled, 1=tproxy, 2=redirect)
DNS_HIJACK_ENABLE=1
# DNS listening port
DNS_PORT="1053"

# The use of 100.0.0.0/8 instead of 100.64.0.0/10 is purely due to a mistake by China Telecom's service provider, and you can change it back
BYPASS_IPv4_LIST="0.0.0.0/8 10.0.0.0/8 100.0.0.0/8 127.0.0.0/8 169.254.0.0/16 172.16.0.0/12 192.0.0.0/24 192.0.2.0/24 192.88.99.0/24 192.168.0.0/16 198.51.100.0/24 203.0.113.0/24 224.0.0.0/4 240.0.0.0/4 255.255.255.255/32"
# IPv6 prefixes for China's three carriers (by default bypassed) : 2409:8000::/20 2408:8000::/20 240e::/18
BYPASS_IPv6_LIST="::/128 ::1/128 ::ffff:0:0/96 100::/64 64:ff9b::/96 2001::/32 2001:10::/28 2001:20::/28 2001:db8::/32 2002::/16 fe80::/10 ff00::/8 2409:8000::/20 2408:8000::/20 240e::/18"
PROXY_IPv4_LIST=""
PROXY_IPv6_LIST=""

# Interface definitions
# Mobile data interface
MOBILE_INTERFACE="rmnet_data+"
# WiFi interface
WIFI_INTERFACE="wlan0"
# Hotspot interface
HOTSPOT_INTERFACE="wlan2"
# USB tethering interface
USB_INTERFACE="rndis+"

# Other interfaces that require bypassing or proxying. Multiple interfaces can be separated by spaces
OTHER_BYPASS_INTERFACES=""
OTHER_PROXY_INTERFACES=""

# Proxy switches
PROXY_MOBILE=1
PROXY_WIFI=1
PROXY_HOTSPOT=0
PROXY_USB=0
PROXY_TCP=1
PROXY_UDP=1

PROXY_IPV6=0

# Per-app proxy (use space to separate package names, supports user:package format)
APP_PROXY_ENABLE=0
PROXY_APPS_LIST=""
# Example: "com.example.app com.other"
BYPASS_APPS_LIST=""
# Example: "com.android.shell"
APP_PROXY_MODE="blacklist"
# "blacklist" or "whitelist"

GID_PROXY_ENABLE=0
PROXY_GIDS_LIST=""
BYPASS_GIDS_LIST=""
GID_PROXY_MODE="blacklist"
# "blacklist" or "whitelist"

# CN IP bypass configuration
BYPASS_CN_IP=0

# block quic
BLOCK_QUIC=0

# MAC address blacklist/whitelist configuration (hotspot mode)
MAC_FILTER_ENABLE=0
# MAC address blacklist/whitelist (use space to separate MAC addresses)
PROXY_MACS_LIST=""
# Example: "AA:BB:CC:DD:EE:FF 11:22:33:44:55:66"
BYPASS_MACS_LIST=""
# Example: "FF:EE:DD:CC:BB:AA"
MAC_PROXY_MODE="blacklist"
# "blacklist" or "whitelist"

# Other
fake_ip_range_v4="198.18.0.0/15"
fake_ip_range_v6="fc00::/18"
tun_device="tun0"

box_path="/data/adb/box"
bin_path="${box_path}/bin/${bin_name}"
run_path="${box_path}/run"
pid_file="${run_path}/${bin_name}.pid"
# CN IP list file paths
CN_IP_FILE="${run_path}/cn.zone"
CN_IPV6_FILE="${run_path}/cn_ipv6.zone"
# CN IP source URLs
CN_IP_URL="https://raw.githubusercontent.com/Hackl0us/GeoIP2-CN/release/CN-ip-cidr.txt"
CN_IPV6_URL="https://ispip.clang.cn/all_cn_ipv6.txt"

clash_api_port=9090
# clash api port

clash_api_secret=
# clash api secret

use_custom_direct=false
# true / false

ctr_mode=disable
# disable / switch / selector / mode

select_outbound=domestic
# Need to switch select type policy groups for proxies

default_outbound=direct
# Default proxies in cellular network

direct_outbound=direct
# Proxies under WLAN

proxy_outbound=
# Proxies under fixed cellular network

direct_outbound_list=""
# Same as direct_outbound. SSID,Proxies, For example:
# CMCC_XXXX,DIRECT;TPLINK_XXXX,ROUTER

default_clash_mode=direct
# Default proxies in cellular network

direct_clash_mode=rule
# Clash Mode when connected to WLAN

proxy_clash_mode=
# Clash Mode when disconnected to WLAN

direct_clash_mode_list=""
# Same as direct_mode. SSID,ClashMode, For example:
# CMCC_XXXX,rule;TPLINK_XXXX,rule-tplink
